# Time-stamp: <2019-09-12 08:04:06 eu>
* Sync
[[elisp:(eu-process "ssm-report ./sy" "./sy" t)][./sy]]
[[elisp:(eu-process "ssm-report ./rr" "./rr" t)][./rr]]

* Upon init
[[elisp:(eu-ssm-report "update-merges")][update-merges: 7m]]
[[elisp:(eu-ssm-report "h1-overlay")][h1-overlay]]
[[elisp:(eu-ssm-report "stat geo")][stat geo]]

* Make trees
** copy trees
d=YYYY-MMMM; for f in h1 h3 bv by; do rsync albertine:/syn/eu/ac/results/signature-pages/$d/$f/tree.json.xz tree/$f.tree.json.xz; done

** make trees
[[elisp:(eu-ssm-report "h1-tree-i")][h1-tree-i]]   [[elisp:(eu-ssm-report "h1-tree")][h1-tree]]   [[elisp:(eu-ssm-report "h1-tree-cumul")][h1-tree-cumul]]    [[file:tree/h1.tree.settings.json][h1.tree.settings.json]]
[[elisp:(eu-ssm-report "h3-tree-i")][h3-tree-i]]   [[elisp:(eu-ssm-report "h3-tree")][h3-tree]]   [[elisp:(eu-ssm-report "h3-tree-cumul")][h3-tree-cumul]]    [[file:tree/h3.tree.settings.json][h3.tree.settings.json]]
[[elisp:(eu-ssm-report "bv-tree-i")][bvic-tree-i]] [[elisp:(eu-ssm-report "bv-tree")][bvic-tree]] [[elisp:(eu-ssm-report "bv-tree-cumul")][bvic-tree-cumul]]  [[file:tree/bv.tree.settings.json][bv.tree.settings.json]]
[[elisp:(eu-ssm-report "by-tree-i")][byam-tree-i]] [[elisp:(eu-ssm-report "by-tree")][byam-tree]] [[elisp:(eu-ssm-report "by-tree-cumul")][byam-tree-cumul]]  [[file:tree/by.tree.settings.json][by.tree.settings.json]]

[[elisp:(eu-ssm-report "h1-tree-aa")][h1-tree-aa]]
[[elisp:(eu-ssm-report "h3-tree-aa")][h3-tree-aa]]
[[elisp:(eu-ssm-report "bv-tree-aa")][bvic-tree-aa]]
[[elisp:(eu-ssm-report "by-tree-aa")][byam-tree-aa]]

* Settings
[[file:h1-geographic.json][h1-geographic.json]] [[file:h1-hi.json][h1-hi.json]] [[file:serology.h1-hi.json][serology.h1-hi.json]] [[file:vaccines.h1-hi.json][vaccines.h1-hi.json]]
[[file:h3-geographic.json][h3-geographic.json]] [[file:h3-hi.json][h3-hi.json]] [[file:serology.h3-hi.json][serology.h3-hi.json]] [[file:vaccines.h3-hi.json][vaccines.h3-hi.json]]
[[file:h3-neut.json][h3-neut.json]] [[file:serology.h3-neut.json][serology.h3-neut.json]] [[file:vaccines.h3-neut.json][vaccines.h3-neut.json]]
[[file:b-geographic.json][b-geographic.json]]
[[file:bv-hi.json][bv-hi.json]] [[file:serology.bv-hi.json][serology.bv-hi.json]] [[file:vaccines.bv-hi.json][vaccines.bv-hi.json]]
[[file:by-hi.json][by-hi.json]] [[file:serology.by-hi.json][serology.by-hi.json]] [[file:vaccines.by-hi.json][vaccines.by-hi.json]]
[[file:report.json][report.json]] [[file:report-serumcoverage.json][report-serumcoverage.json]]

* Make maps
[[elisp:(eu-ssm-report "stat")][stat]] [[elisp:(eu-ssm-report "geo")][geo]]

-- H1
[[elisp:(eu-ssm-report "h1-ts")][h1-ts]]
[[elisp:(eu-ssm-report "h1-clade")][h1-clade]]         [[elisp:(e-run "h1-hi/clade-cdc-i.sh")][h1-cdc-clade-i]]      [[elisp:(e-run "h1-hi/clade-melb-i.sh")][h1-melb-clade-i]]        [[elisp:(e-run "h1-hi/clade-nimr-i.sh")][h1-nimr-clade-i]]
[[elisp:(eu-ssm-report "h1-serology")][h1-serology]]      [[elisp:(e-run "h1-hi/serology-cdc-i.sh")][h1-cdc-serology-i]]   [[elisp:(e-run "h1-hi/serology-melb-i.sh")][h1-melb-serology-i  ]]   [[elisp:(e-run "h1-hi/serology-nimr-i.sh")][h1-nimr-serology-i]]
[[elisp:(eu-ssm-report "h1-geo")][h1-geo]]
[[elisp:(eu-ssm-report "h1-ts h1-clade h1-serology")][h1 ts clade serology]]
[[elisp:(eu-ssm-report "h1-ts h1-clade")][h1 ts clade]]

-- H3 HI
[[elisp:(eu-ssm-report "h3-ts")][h3-ts]]
[[elisp:(eu-ssm-report "h3-clade")][h3-clade]]        [[elisp:(e-run "h3-hi/clade-cdc-i.sh")][h3-cdc-clade-i]]      [[elisp:(e-run "h3-hi/clade-melb-i.sh")][h3-melb-clade-i]]        [[elisp:(e-run "h3-hi/clade-nimr-i.sh")][h3-nimr-clade-i]]
[[elisp:(eu-ssm-report "h3-serology")][h3-serology]]     [[elisp:(e-run "h3-hi/serology-cdc-i.sh")][h3-cdc-serology-i]]   [[elisp:(e-run "h3-hi/serology-melb-i.sh")][h3-melb-serology-i  ]]   [[elisp:(e-run "h3-hi/serology-nimr-i.sh")][h3-nimr-serology-i]]
[[elisp:(eu-ssm-report "h3-geo")][h3-geo]]
[[elisp:(eu-ssm-report "h3-ts h3-clade h3-serology")][h3 ts clade serology]]
[[elisp:(eu-ssm-report "h3-ts h3-clade")][h3 ts clade]]

-- H3 Neut
[[elisp:(eu-ssm-report "h3neut-ts")][h3neut-ts]]
[[elisp:(eu-ssm-report "h3neut-clade")][h3neut-clade]]        [[elisp:(e-run "h3-neut/clade-cdc-i.sh")][h3neut-cdc-clade-i]]      [[elisp:(e-run "h3-neut/clade-melb-i.sh")][h3neut-melb-clade-i]]      [[elisp:(e-run "h3-neut/clade-niid-i.sh")][h3neut-niid-clade-i]]      [[elisp:(e-run "h3-neut/clade-nimr-i.sh")][h3neut-nimr-clade-i]]
[[elisp:(eu-ssm-report "h3neut-serology")][h3neut-serology]]     [[elisp:(e-run "h3-neut/serology-cdc-i.sh")][h3neut-cdc-serology-i]]   [[elisp:(e-run "h3-neut/serology-melb-i.sh")][h3neut-melb-serology-i  ]] [[elisp:(e-run "h3-neut/serology-niid-i.sh")][h3neut-niid-serology-i]]   [[elisp:(e-run "h3-neut/serology-nimr-i.sh")][h3neut-nimr-serology-i]]
[[elisp:(eu-ssm-report "h3neut-geo")][h3neut-geo]]
[[elisp:(eu-ssm-report "h3neut-ts h3neut-clade h3neut-serology")][h3neut ts clade serology]]
[[elisp:(eu-ssm-report "h3neut-ts h3neut-clade")][h3neut ts clade]]

-- B/Vic
[[elisp:(eu-ssm-report "bv-ts")][BVic-ts]]
[[elisp:(eu-ssm-report "bv-clade")][BVic-clade]]     [[elisp:(e-run "bv-hi/clade-cdc-i.sh")][BVic-cdc-clade-i]]       [[elisp:(e-run "bv-hi/clade-melb-i.sh")][BVic-melb-clade-i]]       [[elisp:(e-run "bv-hi/clade-niid-i.sh")][BVic-niid-clade-i]]      [[elisp:(e-run "bv-hi/clade-nimr-i.sh")][BVic-nimr-clade-i]]
[[elisp:(eu-ssm-report "bv-serology")][BVic-serology]]  [[elisp:(e-run "bv-hi/serology-cdc-i.sh")][BVic-cdc-serology-i]]    [[elisp:(e-run "bv-hi/serology-melb-i.sh")][BVic-melb-serology-i]]    [[elisp:(e-run "bv-hi/serology-niid-i.sh")][BVic-niid-serology-i]]   [[elisp:(e-run "bv-hi/serology-nimr-i.sh")][BVic-nimr-serology-i]]
[[elisp:(eu-ssm-report "bv-geo")][BVic-geo]] 
[[elisp:(eu-ssm-report "bv-ts bv-clade bv-serology")][BVic ts clade serology]]
[[elisp:(eu-ssm-report "bv-ts bv-clade")][BVic ts clade]]

-- B/Yam
[[elisp:(eu-ssm-report "by-ts")][BYam-ts]]
[[elisp:(eu-ssm-report "by-clade")][BYam-clade]]     [[elisp:(e-run "by-hi/clade-cdc-i.sh")][BYam-cdc-clade-i]]       [[elisp:(e-run "by-hi/clade-melb-i.sh")][BYam-melb-clade-i]]       [[elisp:(e-run "by-hi/clade-niid-i.sh")][BYam-niid-clade-i]]      [[elisp:(e-run "by-hi/clade-nimr-i.sh")][BYam-nimr-clade-i]]
[[elisp:(eu-ssm-report "by-serology")][BYam-serology]]  [[elisp:(e-run "by-hi/serology-cdc-i.sh")][BYam-cdc-serology-i]]    [[elisp:(e-run "by-hi/serology-melb-i.sh")][BYam-melb-serology-i]]    [[elisp:(e-run "by-hi/serology-niid-i.sh")][BYam-niid-serology-i]]   [[elisp:(e-run "by-hi/serology-nimr-i.sh")][BYam-nimr-serology-i]]
[[elisp:(eu-ssm-report "by-geo")][BYam-geo]] 
[[elisp:(eu-ssm-report "by-ts by-clade by-serology")][BYam ts clade serology]]
[[elisp:(eu-ssm-report "by-ts by-clade")][BYam ts clade]]

[[elisp:(eu-ssm-report "report")][REPORT]]  [[elisp:(eu-process "ssm-report ./rr" "./rr" t)][RR]]

[[elisp:(eu-ssm-report "sp")][sp]]
[[elisp:(eu-ssm-report "sp-h1")][sp-h1]]  [[elisp:(eu-ssm-report "sp-h1-all")][sp-h1-all]]  [[elisp:(eu-ssm-report "sp-h1-cdc")][sp-h1-cdc]]  [[elisp:(eu-ssm-report "sp-h1-melb")][sp-h1-melb]]  [[elisp:(eu-ssm-report "sp-h1-niid")][sp-h1-niid]]  [[elisp:(eu-ssm-report "sp-h1-nimr")][sp-h1-nimr]]
[[elisp:(eu-ssm-report "sp-h3")][sp-h3]]  [[elisp:(eu-ssm-report "sp-h3-cdc")][sp-h3-cdc]]  [[elisp:(eu-ssm-report "sp-h3-melb")][sp-h3-melb]]  [[elisp:(eu-ssm-report "sp-h3-nimr")][sp-h3-nimr]]
[[elisp:(eu-ssm-report "sp-h3neut")][sp-h3neut]]  [[elisp:(eu-ssm-report "sp-h3neut-cdc")][sp-h3neut-cdc]]  [[elisp:(eu-ssm-report "sp-h3neut-melb")][sp-h3neut-melb]]  [[elisp:(eu-ssm-report "sp-h3neut-niid")][sp-h3neut-niid]]  [[elisp:(eu-ssm-report "sp-h3neut-nimr")][sp-h3neut-nimr]]
[[elisp:(eu-ssm-report "sp-bv")][sp-bvic]]  [[elisp:(eu-ssm-report "sp-bv-cdc")][sp-bvic-cdc]]  [[elisp:(eu-ssm-report "sp-bv-melb")][sp-bvic-melb]]  [[elisp:(eu-ssm-report "sp-bv-niid")][sp-bvic-niid]]  [[elisp:(eu-ssm-report "sp-bv-nimr")][sp-bvic-nimr]]
[[elisp:(eu-ssm-report "sp-by")][sp-byam]]  [[elisp:(eu-ssm-report "sp-by-cdc")][sp-byam-cdc]]  [[elisp:(eu-ssm-report "sp-by-melb")][sp-byam-melb]]  [[elisp:(eu-ssm-report "sp-by-niid")][sp-byam-niid]]  [[elisp:(eu-ssm-report "sp-by-nimr")][sp-byam-nimr]]
[[elisp:(eu-ssm-report "sp-addendum")][sp-addendum]]

spsc spsc-h3-cdc spsc-h3neut-cdc spsc-addendum
addendum-3 addendum-4 addendum-5

[[elisp:(eu-ssm-report "zzz")][zzz]]

* Information meeting tree
commands below make changes to tree/*.tree.settings.json and save them as tree/*.tree.information.json

ssm-report h1-tree-information
ssm-report h3-tree-information
ssm-report bv-tree-information
ssm-report by-tree-information
ssm-report h1-information
* Commands
** update hidb on albertine ~1.5min
ssh i19 "whocc-update-ace-store && whocc-hidb5-update"
hidb-get-from-albertine && cp ~/AD/data/hidb5.* db
rm -f stat/* geo/*; ssm-report --force update_hidb stat geo
ssm-report update-merges
** re-make seqdb
seqdb-create --db db/seqdb.json.xz --match-hidb --clades --report-not-aligned-prefixes 32 --save-not-found-locations /d/not-found.txt ~/ac/tables-store/sequences/*.fas.*
cp db/seqdb.json.xz ~/AD/data && rsync -v ~/AD/data/seqdb* albertine:AD/data
** make lispmds save colored by clade
acmacs-map-draw --clade --save merges/cdc-h3-neut.clade.save merges/cdc-h3-neut.ace
** serum coverage
ssm-report serumcoverage-init
ssm-report serumcircle-report-cdc-h3-hi
ssm-report h3-cov       ~4 hours!
ssm-report h3neut-cov   ~40 min
ssm-report serumcoverage-h3-hi
ssm-report serumcoverage-h3-neut
ssm-report serumcoverage-cdc-h3-hi
ssm-report report-serumcoverage
* TODO
** requests
- [ ]
** report
- [ ] All [0/2]
  - [ ] geographical
  - [ ] stat
- [ ] H1 [0/5]
  - [ ] tree
  - [ ] merges
    - [ ] CDC
    - [ ] Crick
    - [ ] NIID
    - [ ] VIDRL
  - [ ] sig pages [0/5]
    - [ ] ALL
    - [ ] CDC
    - [ ] Crick
    - [ ] NIID
    - [ ] VIDRL
  - [ ] clades [0/5]
    - [ ] ALL
    - [ ] CDC
    - [ ] Crick
    - [ ] NIID
    - [ ] VIDRL
  - [ ] ts
  - [ ] serology
- [ ] H3 HI [0/6]
  - [ ] tree
  - [ ] merges
    - [ ] CDC
    - [ ] Crick
    - [ ] VIDRL
  - [ ] sig pages [0/3]
    - [ ] CDC
    - [ ] Crick
    - [ ] VIDRL
  - [ ] clades [0/3]
    - [ ] CDC
    - [ ] Crick
    - [ ] VIDRL
  - [ ] ts [0/3]
    - [ ] CDC
    - [ ] Crick
    - [ ] VIDRL
  - [ ] geography [0/3]
    - [ ] CDC
    - [ ] Crick
    - [ ] VIDRL
  - [ ] serology [0/3]
    - [ ] CDC
    - [ ] Crick
    - [ ] VIDRL
- [ ] H3 Neut [0/5]
  - [ ] merges
    - [ ] CDC
    - [ ] Crick
    - [ ] NIID
    - [ ] VIDRL
  - [ ] sig pages [0/4]
    - [ ] CDC
    - [ ] Crick
    - [ ] NIID
    - [ ] VIDRL
  - [ ] clades [0/4]
    - [ ] CDC
    - [ ] Crick
    - [ ] NIID
    - [ ] VIDRL
  - [ ] ts [0/4]
    - [ ] CDC
    - [ ] Crick
    - [ ] NIID
    - [ ] VIDRL
  - [ ] geography [0/4]
    - [ ] CDC
    - [ ] Crick
    - [ ] NIID
    - [ ] VIDRL
  - [ ] serology [0/4]
    - [ ] CDC
    - [ ] Crick
    - [ ] NIID
    - [ ] VIDRL
- [ ] BVic [0/5]
  - [ ] tree
  - [ ] merges
    - [ ] CDC
    - [ ] Crick
    - [ ] NIID
    - [ ] VIDRL
  - [ ] sig pages [0/4]
    - [ ] CDC
    - [ ] Crick
    - [ ] NIID
    - [ ] VIDRL
  - [ ] clades [0/4]
    - [ ] CDC
    - [ ] Crick
    - [ ] NIID
    - [ ] VIDRL
  - [ ] ts [0/4]
    - [ ] CDC
    - [ ] Crick
    - [ ] NIID
    - [ ] VIDRL
  - [ ] serology [0/4]
    - [ ] CDC
    - [ ] Crick
    - [ ] NIID
    - [ ] VIDRL
- [ ] BYam [0/5]
  - [ ] tree
  - [ ] merges
    - [ ] CDC
    - [ ] Crick
    - [ ] NIID
    - [ ] VIDRL
  - [ ] sig pages [0/4]
    - [ ] CDC
    - [ ] Crick
    - [ ] NIID
    - [ ] VIDRL
  - [ ] clades [0/4]
    - [ ] CDC
    - [ ] Crick
    - [ ] NIID
    - [ ] VIDRL
  - [ ] ts [0/4]
    - [ ] CDC
    - [ ] Crick
    - [ ] NIID
    - [ ] VIDRL
  - [ ] serology [0/4]
    - [ ] CDC
    - [ ] Crick
    - [ ] NIID
    - [ ] VIDRL
* [[file:~/AD/sources/ssm-report/doc/report-prepare.org][report preparation doc]]
* COMMENT ====== local vars
:PROPERTIES:
:VISIBILITY: folded
:END:
#+STARTUP: showall indent
Local Variables:
eval: (auto-fill-mode 0)
eval: (add-hook 'before-save-hook 'time-stamp)
eval: (progn (make-local-variable org-confirm-elisp-link-function) (setq org-confirm-elisp-link-function nil))
End:
